# Railway Config as Code
# This file defines build and deploy settings for all services in the monorepo
# See: https://docs.railway.com/reference/config-as-code
# Railway Monorepo Guide: https://docs.railway.com/guides/monorepo
#
# IMPORTANT: 
# 1. Railway matches services by name - your services in Railway Dashboard must be named exactly "backend" and "frontend"
# 2. Root Directory in Railway Dashboard should be "." (repository root) for both services (monorepo shared)
# 3. Railway config file path should be empty or "railway.toml" (this file)
# 4. Watch paths are configured to prevent unnecessary rebuilds when other services change

# Backend service configuration
[[services]]
name = "backend"
source = "."

[services.build]
builder = "DOCKERFILE"
dockerfilePath = "backend/Dockerfile"

[services.deploy]
healthcheckPath = "/health"
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10

# Frontend service configuration
[[services]]
name = "frontend"
source = "."

[services.build]
builder = "DOCKERFILE"
dockerfilePath = "frontend/Dockerfile"

[services.deploy]
healthcheckPath = "/"
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10

